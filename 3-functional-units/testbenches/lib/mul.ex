defmodule Mul do
  import Bitwise
  def mul(<<a1::1 , a0::1 >>, <<b1::1 , b0::1 >>), do: band(a0, b0) + (band(a0, b1) + band(a1, b0) <<< 1) + (band(a1, b1) <<< 2)
  def mul(<<a1::2 , a0::2 >>, <<b1::2 , b0::2 >>), do: mul(<<a0::2 >>, <<b0::2 >>) + ((mul(<<a0::2 >>, <<b1::2 >>) + mul(<<a1::2 >>, <<b0::2 >>)) <<< 2 ) + (mul(<<a1::2>>, <<b1::2>>) <<< 4 )
  def mul(<<a1::4 , a0::4 >>, <<b1::4 , b0::4 >>), do: mul(<<a0::4 >>, <<b0::4 >>) + ((mul(<<a0::4 >>, <<b1::4 >>) + mul(<<a1::4 >>, <<b0::4 >>)) <<< 4 ) + (mul(<<a1::2>>, <<b1::2>>) <<< 8 )
  def mul(<<a1::8 , a0::8 >>, <<b1::8 , b0::8 >>), do: mul(<<a0::8 >>, <<b0::8 >>) + ((mul(<<a0::8 >>, <<b1::8 >>) + mul(<<a1::8 >>, <<b0::8 >>)) <<< 8 ) + (mul(<<a1::2>>, <<b1::2>>) <<< 16)
  def mul(<<a1::16, a0::16>>, <<b1::16, b0::16>>), do: mul(<<a0::16>>, <<b0::16>>) + ((mul(<<a0::16>>, <<b1::16>>) + mul(<<a1::16>>, <<b0::16>>)) <<< 16) + (mul(<<a1::2>>, <<b1::2>>) <<< 32)
end
